<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyEngine: lib/pico-vfs-REGI-Local Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Glenrose-Flower-Red_n20iqr.webp"/></td>
  <td id="projectalign">
   <div id="projectname">TinyEngine<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A tiny engine built for embedded RP2350 based game consoles. Includes support for Scenes, sprites, text, and DVI output.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_748a07892d0f637ff59934e757ffa80d.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">pico-vfs-REGI-Local Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-subdirs" class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:examples" id="r_examples"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_02b9f7d16b5a0a906d8ae81113054da2.html">examples</a></td></tr>
<tr class="memitem:include" id="r_include"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_d93ed572feb50e9f4407bb2d5849148d.html">include</a></td></tr>
<tr class="memitem:src" id="r_src"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_5584aeaa170479e31351d33e5b059ea9.html">src</a></td></tr>
<tr class="memitem:tests" id="r_tests"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_ce75412898f8b9522fadb50a93042d25.html">tests</a></td></tr>
<tr class="memitem:vendor" id="r_vendor"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_cc3ce6136ef4316272ed36e8d3434f7b.html">vendor</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<h1 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
Thin virtual file system for Raspberry Pi Pico</h1>
<p>Designed specifically for the Raspberry Pi Pico, <span class="tt">pico-vfs</span> is a virtual file system that allows users to efficiently and easily utilize different storage media such as onboard flash memory and SD cards using familiar POSIX and C standard file APIs. It streamlines file operations in embedded projects, providing a flexible and scalable file system.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
Key Features</h1>
<ul>
<li><b>POSIX and C Standard File API Support</b>: Users can perform basic POSIX file operations such as <span class="tt">open</span>, <span class="tt">read</span>, <span class="tt">write</span>, along with higher-level file functions like <span class="tt">fopen</span>, <span class="tt">fread</span>, <span class="tt">fwrite</span> enabling file operations in embedded projects with familiar APIs.</li>
<li><b>Virtual File System</b>: Multiple different file systems can be mounted into a single namespace, allowing programs to operate without needing to consider differences in storage media and file systems.</li>
<li><b>Pre-configured File System</b>: To reduce the time and complexity of initial setup, default file system configurations are included. Additionally, an <span class="tt">AUTO_INIT</span> feature is available to automatically initialize the file system before the execution of <span class="tt"><a class="el" href="class__main_8cxx.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a></span>.</li>
<li><b>Modular Design</b>: pico-vfs adopts a multi-layer architecture, allowing components such as the block device abstraction layer and the file system abstraction layer to be freely exchanged and added.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
Examples of Use Cases</h1>
<p>pico-vfs unlocks various applications for the Raspberry Pi Pico. Here's how it can be used:</p>
<ul>
<li><b>Basic File Usage in Embedded Environments</b>: Manage configuration settings and record debug information using familiar POSIX-compliant file APIs.</li>
<li><b>Elastic MQTT Client</b>: Implements an MQTT client with a local queue to handle network disconnections seamlessly. <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_e_x_a_m_p_l_e.html">View Sample Code</a></li>
<li><b>Complex UNIX Application Porting</b>: Port SQLite3 to the Pico using pico-vfs, enabling complex data management tasks on the device. <a href="https://github.com/oyama/pico-sqlite">Visit pico-sqlite Project</a></li>
</ul>
<p>These are just a few examples. Utilize the flexibility and capabilities of pico-vfs to develop custom solutions tailored to your projects.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
Modular Design Architecture</h1>
<div class="fragment"><div class="line">+---------------------------------+</div>
<div class="line">|         Application Code        |</div>
<div class="line">+---------------------------------+</div>
<div class="line">|       Virtual File System       | &lt;&lt;&lt; POSIX File API Layer</div>
<div class="line">+---------------------------------+</div>
<div class="line">|     littlefs    |      FAT      | &lt;&lt;&lt; File System Layer</div>
<div class="line">+---------------------------------+</div>
<div class="line">|   Flash Memory  |    SD Card    | &lt;&lt;&lt; Block Device Layer</div>
<div class="line">+---------------------------------+</div>
<div class="line">|      Physical Storage Media     |</div>
<div class="line">|      (Flash, SD card, Heap)     |</div>
<div class="line">+---------------------------------+</div>
</div><!-- fragment --><p>pico-vfs employs an architecture designed to achieve efficient and flexible data management. The combination of file systems and block devices is not restricted, allowing for free reconfiguration:</p>
<ul>
<li><b>Block Device Layer</b>: Abstracts differences in physical storage media such as SD cards and flash memory into a consistent interface, enabling developers to easily add or replace storage media.</li>
<li><b>File System Layer</b>: Integrates different file systems such as littlefs and FAT seamlessly, providing transparent data access to applications.</li>
<li><b>POSIX File API Layer</b>: Through the above layers, it offers a standard file API compliant with POSIX, used in desktop and server environments. This allows for immediate implementation of file operations like opening, reading, writing, and closing without the need for additional learning costs.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md21"></a>
Setup and Configuration</h1>
<p>To add pico-vfs to your project, first place the pico-vfs source in your project directory using the following commands:</p>
<div class="fragment"><div class="line">git clone https://github.com/oyama/pico-vfs.git</div>
<div class="line">cd pico-vfs</div>
<div class="line">git submodule update --init</div>
</div><!-- fragment --><p>Next, add the following lines to your project's <span class="tt">CMakeLists.txt</span> to include pico-vfs in the build process:</p>
<div class="fragment"><div class="line"> .txt</div>
<div class="line">add_subdirectory(pico-vfs)</div>
</div><!-- fragment --><p>Then, add the <span class="tt">pico_enable_filesystem</span> function to <span class="tt">CMakeLists.txt</span> to enable the file system:</p>
<div class="fragment"><div class="line"> .txt</div>
<div class="line">pico_enable_filesystem(${CMAKE_PROJECT_NAME})</div>
</div><!-- fragment --><p> This sets up your project to use the pico-vfs file system functionality. From your program, call the file system initialization function <span class="tt"><a class="el" href="group__filesystem.html#gafb19e37469a751aa61de3dcd0c70b4b0" title="Enable predefined file systems.">fs_init()</a></span> to start using it:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;pico/stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="vfs_8h.html">filesystem/vfs.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="class__main_8cxx.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">void</span>) {</div>
<div class="line">    stdio_init_all();</div>
<div class="line">    <a class="code hl_function" href="group__filesystem.html#gafb19e37469a751aa61de3dcd0c70b4b0">fs_init</a>();</div>
<div class="line"> </div>
<div class="line">    FILE *fp = fopen(<span class="stringliteral">&quot;HELLO.TXT&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">    fprintf(fp, <span class="stringliteral">&quot;Hello World!\n&quot;</span>);</div>
<div class="line">    fclose(fp);</div>
<div class="line">}</div>
<div class="ttc" id="aclass__main_8cxx_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="class__main_8cxx.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="class__main_8cxx_source.html#l00012">class_main.cxx:12</a></div></div>
<div class="ttc" id="agroup__filesystem_html_gafb19e37469a751aa61de3dcd0c70b4b0"><div class="ttname"><a href="group__filesystem.html#gafb19e37469a751aa61de3dcd0c70b4b0">fs_init</a></div><div class="ttdeci">bool fs_init(void)</div><div class="ttdoc">Enable predefined file systems.</div><div class="ttdef"><b>Definition</b> <a href="examples_2freertos__benchmark_2fs__init_8c_source.html#l00016">fs_init.c:16</a></div></div>
<div class="ttc" id="avfs_8h_html"><div class="ttname"><a href="vfs_8h.html">vfs.h</a></div></div>
</div><!-- fragment --><p> By default, 1.4MB of littlefs is mounted at /, and the Pico's onboard flash memory is used as a block device.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md22"></a>
Usage Guide</h1>
<p>For detailed usage examples, refer to <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_e_x_a_m_p_l_e.html">EXAMPLE</a>. For configuration examples involving various block devices and file systems, refer to <a href="examples/fs_inits/">examples/fs_inits</a>. These include examples such as mounting a FAT file system on an SD card and littlefs on onboard flash memory into a single namespace.</p>
<p>Additionally, a list of POSIX standard file APIs verified to work with pico-vfs is available in <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_s_t_a_n_d_a_r_d.html">STANDARD</a>. Refer to this document to check which APIs are available. For management APIs not included in the POSIX standard, such as file system formatting and mounting, refer to <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_a_p_i.html">API</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md23"></a>
Limitations</h1>
<p>For detailed limitations, refer to <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_l_i_m_i_t_a_t_i_o_n.html">LIMITATION</a>. This document provides detailed explanations of potential limitations in specific scenarios and configurations.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md24"></a>
License</h1>
<p>This project is licensed under the 3-Clause BSD License. For details, see the <a class="el" href="md_lib_2pico-vfs-_r_e_g_i-_local_2_l_i_c_e_n_s_e.html">LICENSE</a> file.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md25"></a>
Related Projects and Inspirations</h1>
<p>There are multiple ways to add filesystems to the pico-sdk environment. Firstly, FatFs[^1] and littlefs<a href="[littlefs](https://github.com/littlefs-project/littlefs)">^2</a> are popular file system implementations. These filesystem implementations require writing drivers for the block devices used. They also each have their own Unix-like API, but with a distinctive dialect.</p>
<p>While there are several solutions that cover the problem of writing drivers for the Raspberry Pi Pico, the carlk3[^3] implementation is probably the most popular. Especially, it includes DMA support to reduce CPU load and support for even faster SDIO<a href="[SDIO/iSDIO](https://www.sdcard.org/developers/sd-standard-overview/sdio-isdio/)">^4</a>. This would be the first choice for projects using SD cards and the FAT file system with pico-sdk.</p>
<p>Among multi-filesystem implementations, Memotech-Bill[^5] implementation provides standard I/O support for pico-sdk using the Newlib[^6] hook. The littlefs file system for on-board flash and FatFs for SD cards can be operated as an integrated file system. It is an ambitious project that goes beyond files and integrates character devices such as TTYs and UARTs.</p>
<p>While referring to these existing projects, pico-vfs was developed with the aim of separating and making interchangeable the implementation of drivers and file systems for block devices. This provides functionality similar to that of MicroPython's VFS[^7]and ARM Mbed OS's Storage[^8].</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md26"></a>
References</h1>
<p>[^1]: <a href="http://elm-chan.org/fsw/ff/">Generic FAT Filesystem Module</a></p>
<p>[^3]: <a href="https://github.com/carlk3/no-OS-FatFS-SD-SDIO-SPI-RPi-Pico">C/C++ Library for SD Cards on the Pico</a></p>
<p>[^5]: <a href="https://github.com/Memotech-Bill/pico-filesystem">Standard File Input / Output for the Pico SDK</a> [^6]: <a href="https://www.sourceware.org/newlib/">Newlib is a C library intended for use on embedded systems</a> [^7]: <a href="https://docs.micropython.org/en/latest/reference/filesystem.html">MicroPython Working with filesystems</a> [^8]: <a href="https://os.mbed.com/docs/mbed-os/v6.16/apis/data-storage-concepts.html">ARM Mbed OS - Data storage concepts</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a href="dir_748a07892d0f637ff59934e757ffa80d.html">pico-vfs-REGI-Local</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
