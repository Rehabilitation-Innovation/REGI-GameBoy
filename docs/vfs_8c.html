<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinyEngine: lib/pico-vfs-REGI-Local/src/filesystem/vfs.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Glenrose-Flower-Red_n20iqr.webp"/></td>
  <td id="projectalign">
   <div id="projectname">TinyEngine<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A tiny engine built for embedded RP2350 based game consoles. Includes support for Scenes, sprites, text, and DVI output.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('vfs_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">vfs.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;sys/errno.h&gt;</code><br />
<code>#include &lt;<a class="el" href="dirent_8h_source.html">sys/dirent.h</a>&gt;</code><br />
<code>#include &lt;sys/unistd.h&gt;</code><br />
<code>#include &lt;pico/mutex.h&gt;</code><br />
<code>#include &quot;<a class="el" href="vfs_8h_source.html">filesystem/vfs.h</a>&quot;</code><br />
</div>
<p><a href="vfs_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:mountpoint_5Ft" id="r_mountpoint_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmountpoint__t.html">mountpoint_t</a></td></tr>
<tr class="memitem:file_5Fdescriptor_5Ft" id="r_file_5Fdescriptor_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfile__descriptor__t.html">file_descriptor_t</a></td></tr>
<tr class="memitem:dir_5Fdescriptor_5Ft" id="r_dir_5Fdescriptor_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdir__descriptor__t.html">dir_descriptor_t</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad12537cb47987ba10b4fac6446cf49fa" id="r_ad12537cb47987ba10b4fac6446cf49fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad12537cb47987ba10b4fac6446cf49fa">PICO_VFS_MAX_MOUNTPOINT</a>&#160;&#160;&#160;10</td></tr>
<tr class="memitem:a4a9d13c5a7d33570511593f81d8aa493" id="r_a4a9d13c5a7d33570511593f81d8aa493"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a9d13c5a7d33570511593f81d8aa493">FS_MAX_MOUNTPOINT</a>&#160;&#160;&#160;<a class="el" href="#ad12537cb47987ba10b4fac6446cf49fa">PICO_VFS_MAX_MOUNTPOINT</a></td></tr>
<tr class="memitem:a0718d44242f5b7416ec3311212081e65" id="r_a0718d44242f5b7416ec3311212081e65"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0718d44242f5b7416ec3311212081e65">STDIO_FILNO_MAX</a>&#160;&#160;&#160;STDERR_FILENO</td></tr>
<tr class="memitem:aa07c3cee02f6b8388d5616d76f19dcbf" id="r_aa07c3cee02f6b8388d5616d76f19dcbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa07c3cee02f6b8388d5616d76f19dcbf">FILENO_VALUE</a>(fd)</td></tr>
<tr class="memitem:a21683c936cc59a04b06c1fd39c40b7df" id="r_a21683c936cc59a04b06c1fd39c40b7df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fd)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac9f86bdbfdf77fb98f51551c4b6068ed" id="r_gac9f86bdbfdf77fb98f51551c4b6068ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#gac9f86bdbfdf77fb98f51551c4b6068ed">fs_format</a> (<a class="el" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs, <a class="el" href="group__blockdevice.html#ga4bc2c146f975b5250be7f8f5f219f5e4">blockdevice_t</a> *device)</td></tr>
<tr class="memdesc:gac9f86bdbfdf77fb98f51551c4b6068ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format block device with specify file system.  <br /></td></tr>
<tr class="memitem:ga85336fdeb00149559c5c2008256c3013" id="r_ga85336fdeb00149559c5c2008256c3013"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#ga85336fdeb00149559c5c2008256c3013">fs_mount</a> (const char *dir, <a class="el" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs, <a class="el" href="group__blockdevice.html#ga4bc2c146f975b5250be7f8f5f219f5e4">blockdevice_t</a> *device)</td></tr>
<tr class="memdesc:ga85336fdeb00149559c5c2008256c3013"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mount a file system.  <br /></td></tr>
<tr class="memitem:ga16e3ebc7a28d4b1ba08759b03ec739ff" id="r_ga16e3ebc7a28d4b1ba08759b03ec739ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#ga16e3ebc7a28d4b1ba08759b03ec739ff">fs_unmount</a> (const char *path)</td></tr>
<tr class="memdesc:ga16e3ebc7a28d4b1ba08759b03ec739ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dismount a file system.  <br /></td></tr>
<tr class="memitem:ga72d0b65b57fe9e8c02c149a20c5fc0cd" id="r_ga72d0b65b57fe9e8c02c149a20c5fc0cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#ga72d0b65b57fe9e8c02c149a20c5fc0cd">fs_reformat</a> (const char *path)</td></tr>
<tr class="memdesc:ga72d0b65b57fe9e8c02c149a20c5fc0cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reformat the mounted file system.  <br /></td></tr>
<tr class="memitem:ga9b690589883c3b7e8364ca1817ff6986" id="r_ga9b690589883c3b7e8364ca1817ff6986"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#ga9b690589883c3b7e8364ca1817ff6986">fs_info</a> (const char *path, <a class="el" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> **fs, <a class="el" href="group__blockdevice.html#ga4bc2c146f975b5250be7f8f5f219f5e4">blockdevice_t</a> **device)</td></tr>
<tr class="memdesc:ga9b690589883c3b7e8364ca1817ff6986"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup filesystem and blockdevice objects from a mount point.  <br /></td></tr>
<tr class="memitem:a11bde836cab6ec72897ede2286350e72" id="r_a11bde836cab6ec72897ede2286350e72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11bde836cab6ec72897ede2286350e72">_unlink</a> (const char *path)</td></tr>
<tr class="memitem:a2ce7c2db9fdb6aec06afaf3cfc5979c7" id="r_a2ce7c2db9fdb6aec06afaf3cfc5979c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ce7c2db9fdb6aec06afaf3cfc5979c7">rename</a> (const char *old, const char *new)</td></tr>
<tr class="memitem:a548e5b744ca2e97beb61ad7aa41114e2" id="r_a548e5b744ca2e97beb61ad7aa41114e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a548e5b744ca2e97beb61ad7aa41114e2">mkdir</a> (const char *path, mode_t mode)</td></tr>
<tr class="memitem:ab2df76f2c62ae012c2e417813b5fe8ce" id="r_ab2df76f2c62ae012c2e417813b5fe8ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2df76f2c62ae012c2e417813b5fe8ce">rmdir</a> (const char *path)</td></tr>
<tr class="memitem:a43bfed3654a97b85373f2d4198990c8d" id="r_a43bfed3654a97b85373f2d4198990c8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43bfed3654a97b85373f2d4198990c8d">_stat</a> (const char *path, struct stat *st)</td></tr>
<tr class="memitem:a96ed08daea40a660b6059ae5ddd9d063" id="r_a96ed08daea40a660b6059ae5ddd9d063"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a96ed08daea40a660b6059ae5ddd9d063">_fstat</a> (int fildes, struct stat *st)</td></tr>
<tr class="memitem:aeea6b1ce10c4ced8db50f44cb6774b01" id="r_aeea6b1ce10c4ced8db50f44cb6774b01"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeea6b1ce10c4ced8db50f44cb6774b01">_open</a> (const char *path, int oflags,...)</td></tr>
<tr class="memitem:a5af2dad9b50913a0025ea80a8577bea8" id="r_a5af2dad9b50913a0025ea80a8577bea8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5af2dad9b50913a0025ea80a8577bea8">_close</a> (int fildes)</td></tr>
<tr class="memitem:a90927805d6b48285139ab31098623df1" id="r_a90927805d6b48285139ab31098623df1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90927805d6b48285139ab31098623df1">stdio_flush</a> (void)</td></tr>
<tr class="memitem:a637f3b33cf8a2223862596efdee3ad33" id="r_a637f3b33cf8a2223862596efdee3ad33"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a637f3b33cf8a2223862596efdee3ad33">_write</a> (int fildes, const void *buf, size_t nbyte)</td></tr>
<tr class="memitem:a6cfdb1d41006cb00b54a113c28dd3ab3" id="r_a6cfdb1d41006cb00b54a113c28dd3ab3"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cfdb1d41006cb00b54a113c28dd3ab3">_read</a> (int fildes, void *buf, size_t nbyte)</td></tr>
<tr class="memitem:a1fd116a5c6d658acbe5e5786fa3e1868" id="r_a1fd116a5c6d658acbe5e5786fa3e1868"><td class="memItemLeft" align="right" valign="top">off_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fd116a5c6d658acbe5e5786fa3e1868">_lseek</a> (int fildes, off_t offset, int whence)</td></tr>
<tr class="memitem:a9aedef60c47f7d3a05512b2a488c1d7d" id="r_a9aedef60c47f7d3a05512b2a488c1d7d"><td class="memItemLeft" align="right" valign="top">off_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9aedef60c47f7d3a05512b2a488c1d7d">_ftello_r</a> (struct _reent *ptr, register FILE *fp)</td></tr>
<tr class="memitem:a30e12ed09db8f77b0b4e7ffc5f1f609b" id="r_a30e12ed09db8f77b0b4e7ffc5f1f609b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30e12ed09db8f77b0b4e7ffc5f1f609b">ftruncate</a> (int fildes, off_t length)</td></tr>
<tr class="memitem:ad759a0269427a564f3ce672d43e885cf" id="r_ad759a0269427a564f3ce672d43e885cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad759a0269427a564f3ce672d43e885cf">opendir</a> (const char *path)</td></tr>
<tr class="memitem:ac0258906f9453b8abf03e945aa9c9676" id="r_ac0258906f9453b8abf03e945aa9c9676"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0258906f9453b8abf03e945aa9c9676">closedir</a> (<a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> *dir)</td></tr>
<tr class="memitem:ab1ebcf210f49b305423bcc413c6427ee" id="r_ab1ebcf210f49b305423bcc413c6427ee"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdirent.html">dirent</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1ebcf210f49b305423bcc413c6427ee">readdir</a> (<a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> *dir)</td></tr>
<tr class="memitem:ga852f1a8efec7c0556f59cdb951ab96c4" id="r_ga852f1a8efec7c0556f59cdb951ab96c4"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__filesystem.html#ga852f1a8efec7c0556f59cdb951ab96c4">fs_strerror</a> (int errnum)</td></tr>
<tr class="memdesc:ga852f1a8efec7c0556f59cdb951ab96c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">File system error message.  <br /></td></tr>
</table>
<a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a21683c936cc59a04b06c1fd39c40b7df" name="a21683c936cc59a04b06c1fd39c40b7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21683c936cc59a04b06c1fd39c40b7df">&#9670;&#160;</a></span>FILENO_INDEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FILENO_INDEX</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(fd - <a class="code hl_define" href="#a0718d44242f5b7416ec3311212081e65">STDIO_FILNO_MAX</a> - 1)</div>
<div class="ttc" id="avfs_8c_html_a0718d44242f5b7416ec3311212081e65"><div class="ttname"><a href="#a0718d44242f5b7416ec3311212081e65">STDIO_FILNO_MAX</a></div><div class="ttdeci">#define STDIO_FILNO_MAX</div><div class="ttdef"><b>Definition</b> <a href="vfs_8c_source.html#l00036">vfs.c:36</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00038">38</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>

</div>
</div>
<a id="aa07c3cee02f6b8388d5616d76f19dcbf" name="aa07c3cee02f6b8388d5616d76f19dcbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07c3cee02f6b8388d5616d76f19dcbf">&#9670;&#160;</a></span>FILENO_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FILENO_VALUE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(fd + <a class="code hl_define" href="#a0718d44242f5b7416ec3311212081e65">STDIO_FILNO_MAX</a> + 1)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00037">37</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>

</div>
</div>
<a id="a4a9d13c5a7d33570511593f81d8aa493" name="a4a9d13c5a7d33570511593f81d8aa493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a9d13c5a7d33570511593f81d8aa493">&#9670;&#160;</a></span>FS_MAX_MOUNTPOINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FS_MAX_MOUNTPOINT&#160;&#160;&#160;<a class="el" href="#ad12537cb47987ba10b4fac6446cf49fa">PICO_VFS_MAX_MOUNTPOINT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00035">35</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>

</div>
</div>
<a id="ad12537cb47987ba10b4fac6446cf49fa" name="ad12537cb47987ba10b4fac6446cf49fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12537cb47987ba10b4fac6446cf49fa">&#9670;&#160;</a></span>PICO_VFS_MAX_MOUNTPOINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PICO_VFS_MAX_MOUNTPOINT&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00033">33</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>

</div>
</div>
<a id="a0718d44242f5b7416ec3311212081e65" name="a0718d44242f5b7416ec3311212081e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0718d44242f5b7416ec3311212081e65">&#9670;&#160;</a></span>STDIO_FILNO_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STDIO_FILNO_MAX&#160;&#160;&#160;STDERR_FILENO</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00036">36</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a5af2dad9b50913a0025ea80a8577bea8" name="a5af2dad9b50913a0025ea80a8577bea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af2dad9b50913a0025ea80a8577bea8">&#9670;&#160;</a></span>_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _close </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00444">444</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  444</span>                       {</div>
<div class="line"><span class="lineno">  445</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  446</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  449</span>        printf(<span class="stringliteral">&quot;_close error fildes=%d\n&quot;</span>, fildes);</div>
<div class="line"><span class="lineno">  450</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  452</span>    }</div>
<div class="line"><span class="lineno">  453</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  454</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  456</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  458</span>    }</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#ab649defbea72289a00b64b6eabdd1b4d">file_close</a>(fs, file);</div>
<div class="line"><span class="lineno">  460</span>    free(file);</div>
<div class="line"><span class="lineno">  461</span>    file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem = NULL;</div>
<div class="line"><span class="lineno">  462</span>    file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file = NULL;</div>
<div class="line"><span class="lineno">  463</span>    file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].path[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  467</span>}</div>
<div class="ttc" id="agroup__filesystem_html_gad16024c6aa37d328b78a38f8c006ac83"><div class="ttname"><a href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a></div><div class="ttdeci">struct filesystem filesystem_t</div><div class="ttdoc">file system abstract object</div></div>
<div class="ttc" id="astructfilesystem_html_ab649defbea72289a00b64b6eabdd1b4d"><div class="ttname"><a href="structfilesystem.html#ab649defbea72289a00b64b6eabdd1b4d">filesystem::file_close</a></div><div class="ttdeci">int(* file_close)(struct filesystem *fs, fs_file_t *file)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00082">filesystem.h:82</a></div></div>
<div class="ttc" id="astructfs__file__t_html"><div class="ttname"><a href="structfs__file__t.html">fs_file_t</a></div><div class="ttdoc">file object</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00045">filesystem.h:45</a></div></div>
<div class="ttc" id="avfs_8c_html_a21683c936cc59a04b06c1fd39c40b7df"><div class="ttname"><a href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a></div><div class="ttdeci">#define FILENO_INDEX(fd)</div><div class="ttdef"><b>Definition</b> <a href="vfs_8c_source.html#l00038">vfs.c:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96ed08daea40a660b6059ae5ddd9d063" name="a96ed08daea40a660b6059ae5ddd9d063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ed08daea40a660b6059ae5ddd9d063">&#9670;&#160;</a></span>_fstat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _fstat </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00275">275</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>                                        {</div>
<div class="line"><span class="lineno">  276</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  277</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">if</span> (fildes == STDIN_FILENO || fildes == STDOUT_FILENO || fildes == STDERR_FILENO) {</div>
<div class="line"><span class="lineno">  280</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  281</span>        st-&gt;st_size = 0;</div>
<div class="line"><span class="lineno">  282</span>        st-&gt;st_mode = S_IFCHR;</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">return</span> _error_remap(0);</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  286</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  288</span>    }</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  293</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    off_t size = 0;</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> (fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a4ba3d1ab6d89005e297c86eb8bafd225">type</a> != <a class="code hl_enumvalue" href="filesystem_8h.html#ae11c5ff9c996a8d72f65fcf4d52f4804a0c11236c0a4aca6a7701b384bdc11d92">FILESYSTEM_TYPE_FAT</a>) {</div>
<div class="line"><span class="lineno">  299</span>        off_t current = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#acdf7fe4f2c1ef87fc1f2894cf473d271">file_tell</a>(fs, file);</div>
<div class="line"><span class="lineno">  300</span>        size = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a42ee5c83a7fe9edddb0181f9b54d7b00">file_seek</a>(fs, file, 0, SEEK_END);</div>
<div class="line"><span class="lineno">  301</span>        off_t err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a42ee5c83a7fe9edddb0181f9b54d7b00">file_seek</a>(fs, file, current, SEEK_SET);</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">if</span> (current != err) {</div>
<div class="line"><span class="lineno">  303</span>            recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  305</span>        }</div>
<div class="line"><span class="lineno">  306</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  307</span>        <span class="comment">/* NOTE: Support for different behaviour of FatFs from POSIX</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">         * FatFs has a problem where f_size() reports a larger than actual file size when</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">         * moved to a position beyond the f_lseek() file size; POSIX reports the actual size</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">         * written to the file, not the seek position.</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *path = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].path;</div>
<div class="line"><span class="lineno">  314</span>        <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  316</span>            recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  318</span>        }</div>
<div class="line"><span class="lineno">  319</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        <span class="keyword">struct </span>stat finfo = {0};</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#ab5f68a612c88a96e638d2035a7ec59fd">stat</a>(fs, entity_path, &amp;finfo);</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line"><span class="lineno">  325</span>            recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  327</span>        }</div>
<div class="line"><span class="lineno">  328</span>        size = finfo.st_size;</div>
<div class="line"><span class="lineno">  329</span>    }</div>
<div class="line"><span class="lineno">  330</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    st-&gt;st_size = size;</div>
<div class="line"><span class="lineno">  333</span>    st-&gt;st_mode = S_IFREG;</div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordflow">return</span> _error_remap(0);</div>
<div class="line"><span class="lineno">  335</span>}</div>
<div class="ttc" id="afilesystem_8h_html_ae11c5ff9c996a8d72f65fcf4d52f4804a0c11236c0a4aca6a7701b384bdc11d92"><div class="ttname"><a href="filesystem_8h.html#ae11c5ff9c996a8d72f65fcf4d52f4804a0c11236c0a4aca6a7701b384bdc11d92">FILESYSTEM_TYPE_FAT</a></div><div class="ttdeci">@ FILESYSTEM_TYPE_FAT</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00025">filesystem.h:25</a></div></div>
<div class="ttc" id="astructfilesystem_html_a42ee5c83a7fe9edddb0181f9b54d7b00"><div class="ttname"><a href="structfilesystem.html#a42ee5c83a7fe9edddb0181f9b54d7b00">filesystem::file_seek</a></div><div class="ttdeci">off_t(* file_seek)(struct filesystem *fs, fs_file_t *file, off_t offset, int whence)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00086">filesystem.h:86</a></div></div>
<div class="ttc" id="astructfilesystem_html_a4ba3d1ab6d89005e297c86eb8bafd225"><div class="ttname"><a href="structfilesystem.html#a4ba3d1ab6d89005e297c86eb8bafd225">filesystem::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00067">filesystem.h:67</a></div></div>
<div class="ttc" id="astructfilesystem_html_ab5f68a612c88a96e638d2035a7ec59fd"><div class="ttname"><a href="structfilesystem.html#ab5f68a612c88a96e638d2035a7ec59fd">filesystem::stat</a></div><div class="ttdeci">int(* stat)(struct filesystem *fs, const char *path, struct stat *st)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00079">filesystem.h:79</a></div></div>
<div class="ttc" id="astructfilesystem_html_acdf7fe4f2c1ef87fc1f2894cf473d271"><div class="ttname"><a href="structfilesystem.html#acdf7fe4f2c1ef87fc1f2894cf473d271">filesystem::file_tell</a></div><div class="ttdeci">off_t(* file_tell)(struct filesystem *fs, fs_file_t *file)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00087">filesystem.h:87</a></div></div>
<div class="ttc" id="astructmountpoint__t_html"><div class="ttname"><a href="structmountpoint__t.html">mountpoint_t</a></div><div class="ttdef"><b>Definition</b> <a href="vfs_8c_source.html#l00015">vfs.c:15</a></div></div>
<div class="ttc" id="astructmountpoint__t_html_a0e33cd9afdf66cdf0417e94e6580d723"><div class="ttname"><a href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">mountpoint_t::filesystem</a></div><div class="ttdeci">void * filesystem</div><div class="ttdef"><b>Definition</b> <a href="vfs_8c_source.html#l00017">vfs.c:17</a></div></div>
<div class="ttc" id="astructmountpoint__t_html_ab8b25dab2ca0301ce0190df5f4efff0d"><div class="ttname"><a href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">mountpoint_t::dir</a></div><div class="ttdeci">const char * dir</div><div class="ttdef"><b>Definition</b> <a href="vfs_8c_source.html#l00016">vfs.c:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9aedef60c47f7d3a05512b2a488c1d7d" name="a9aedef60c47f7d3a05512b2a488c1d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aedef60c47f7d3a05512b2a488c1d7d">&#9670;&#160;</a></span>_ftello_r()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">off_t _ftello_r </td>
          <td>(</td>
          <td class="paramtype">struct _reent *</td>          <td class="paramname"><span class="paramname"><em>ptr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00565">565</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>                                                       {</div>
<div class="line"><span class="lineno">  566</span>    (void)ptr;</div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordtype">int</span> fildes = fp-&gt;_file;</div>
<div class="line"><span class="lineno">  568</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  569</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  572</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  574</span>    }</div>
<div class="line"><span class="lineno">  575</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  578</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  580</span>    }</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>    off_t pos = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#acdf7fe4f2c1ef87fc1f2894cf473d271">file_tell</a>(fs, file);</div>
<div class="line"><span class="lineno">  583</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">return</span> _error_remap(pos);</div>
<div class="line"><span class="lineno">  586</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fd116a5c6d658acbe5e5786fa3e1868" name="a1fd116a5c6d658acbe5e5786fa3e1868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fd116a5c6d658acbe5e5786fa3e1868">&#9670;&#160;</a></span>_lseek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">off_t _lseek </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>whence</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00544">544</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  544</span>                                                   {</div>
<div class="line"><span class="lineno">  545</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  546</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  549</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  551</span>    }</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  554</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  555</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  557</span>    }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    off_t pos = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a42ee5c83a7fe9edddb0181f9b54d7b00">file_seek</a>(fs, file, offset, whence);</div>
<div class="line"><span class="lineno">  560</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="keywordflow">return</span> _error_remap(pos);</div>
<div class="line"><span class="lineno">  563</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeea6b1ce10c4ced8db50f44cb6774b01" name="aeea6b1ce10c4ced8db50f44cb6774b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeea6b1ce10c4ced8db50f44cb6774b01">&#9670;&#160;</a></span>_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _open </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>oflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>...</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00405">405</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  405</span>                                             {</div>
<div class="line"><span class="lineno">  406</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  407</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  411</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  413</span>    }</div>
<div class="line"><span class="lineno">  414</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  415</span>    <span class="comment">// find file descriptor</span></div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordtype">int</span> fd = _assign_file_descriptor();</div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">if</span> (fd == -1) {</div>
<div class="line"><span class="lineno">  418</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">return</span> _error_remap(-ENFILE);</div>
<div class="line"><span class="lineno">  420</span>    }</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fd)].file = calloc(1, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a>));</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> (file == NULL) {</div>
<div class="line"><span class="lineno">  425</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">return</span> _error_remap(-ENOMEM);</div>
<div class="line"><span class="lineno">  427</span>    }</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a28f1a1f90cf5c05660e20b20e55cf1c7">file_open</a>(fs, file, entity_path, oflags);</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line"><span class="lineno">  431</span>        free(file);</div>
<div class="line"><span class="lineno">  432</span>        file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fd)].file = NULL;</div>
<div class="line"><span class="lineno">  433</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  435</span>    }</div>
<div class="line"><span class="lineno">  436</span>    file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fd)].filesystem = fs;</div>
<div class="line"><span class="lineno">  437</span>    strncpy(file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fd)].path, path, <a class="code hl_define" href="filesystem_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>);</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">return</span> _error_remap(fd);</div>
<div class="line"><span class="lineno">  442</span>}</div>
<div class="ttc" id="afilesystem_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="filesystem_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00022">filesystem.h:22</a></div></div>
<div class="ttc" id="astructfilesystem_html_a28f1a1f90cf5c05660e20b20e55cf1c7"><div class="ttname"><a href="structfilesystem.html#a28f1a1f90cf5c05660e20b20e55cf1c7">filesystem::file_open</a></div><div class="ttdeci">int(* file_open)(struct filesystem *fs, fs_file_t *file, const char *path, int flags)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00081">filesystem.h:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cfdb1d41006cb00b54a113c28dd3ab3" name="a6cfdb1d41006cb00b54a113c28dd3ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfdb1d41006cb00b54a113c28dd3ab3">&#9670;&#160;</a></span>_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t _read </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>nbyte</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00518">518</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  518</span>                                                   {</div>
<div class="line"><span class="lineno">  519</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  520</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">if</span> (fildes == STDIN_FILENO) {</div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordtype">size_t</span> read_bytes = pico_stdio_fallback_read(buf, nbyte);</div>
<div class="line"><span class="lineno">  524</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  525</span>        <span class="keywordflow">return</span> read_bytes;</div>
<div class="line"><span class="lineno">  526</span>    }</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  528</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  532</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  534</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  536</span>    }</div>
<div class="line"><span class="lineno">  537</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    ssize_t size = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#afa641bc200d34300f3306a7f2b1c0794">file_read</a>(fs, file, buf, nbyte);</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">return</span> _error_remap(size);</div>
<div class="line"><span class="lineno">  542</span>}</div>
<div class="ttc" id="astructfilesystem_html_afa641bc200d34300f3306a7f2b1c0794"><div class="ttname"><a href="structfilesystem.html#afa641bc200d34300f3306a7f2b1c0794">filesystem::file_read</a></div><div class="ttdeci">ssize_t(* file_read)(struct filesystem *fs, fs_file_t *file, void *buffer, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00084">filesystem.h:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43bfed3654a97b85373f2d4198990c8d" name="a43bfed3654a97b85373f2d4198990c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43bfed3654a97b85373f2d4198990c8d">&#9670;&#160;</a></span>_stat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _stat </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>st</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00260">260</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  260</span>                                             {</div>
<div class="line"><span class="lineno">  261</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  262</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  265</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  270</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#ab5f68a612c88a96e638d2035a7ec59fd">stat</a>(fs, entity_path, st);</div>
<div class="line"><span class="lineno">  271</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  273</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a11bde836cab6ec72897ede2286350e72" name="a11bde836cab6ec72897ede2286350e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11bde836cab6ec72897ede2286350e72">&#9670;&#160;</a></span>_unlink()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _unlink </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00196">196</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>                              {</div>
<div class="line"><span class="lineno">  197</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  198</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  202</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a168c6ebc947bcef4dd441c4846199663">remove</a>(fs, entity_path);</div>
<div class="line"><span class="lineno">  208</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  210</span>}</div>
<div class="ttc" id="astructfilesystem_html_a168c6ebc947bcef4dd441c4846199663"><div class="ttname"><a href="structfilesystem.html#a168c6ebc947bcef4dd441c4846199663">filesystem::remove</a></div><div class="ttdeci">int(* remove)(struct filesystem *fs, const char *path)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00075">filesystem.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a637f3b33cf8a2223862596efdee3ad33" name="a637f3b33cf8a2223862596efdee3ad33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a637f3b33cf8a2223862596efdee3ad33">&#9670;&#160;</a></span>_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t _write </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>nbyte</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00492">492</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  492</span>                                                          {</div>
<div class="line"><span class="lineno">  493</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  494</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">if</span> (fildes == STDOUT_FILENO || fildes == STDERR_FILENO) {</div>
<div class="line"><span class="lineno">  497</span>        pico_stdio_fallback_write(buf, nbyte);</div>
<div class="line"><span class="lineno">  498</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">return</span> (ssize_t)nbyte;</div>
<div class="line"><span class="lineno">  500</span>    }</div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  502</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  504</span>    }</div>
<div class="line"><span class="lineno">  505</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  506</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  508</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  510</span>    }</div>
<div class="line"><span class="lineno">  511</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    ssize_t size = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#aa101ba0e335b6b94b615cd27edbef29f">file_write</a>(fs, file, buf, nbyte);</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    <span class="keywordflow">return</span> _error_remap(size);</div>
<div class="line"><span class="lineno">  516</span>}</div>
<div class="ttc" id="astructfilesystem_html_aa101ba0e335b6b94b615cd27edbef29f"><div class="ttname"><a href="structfilesystem.html#aa101ba0e335b6b94b615cd27edbef29f">filesystem::file_write</a></div><div class="ttdeci">ssize_t(* file_write)(struct filesystem *fs, fs_file_t *file, const void *buffer, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00083">filesystem.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0258906f9453b8abf03e945aa9c9676" name="ac0258906f9453b8abf03e945aa9c9676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0258906f9453b8abf03e945aa9c9676">&#9670;&#160;</a></span>closedir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int closedir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00650">650</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  650</span>                       {</div>
<div class="line"><span class="lineno">  651</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  652</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordtype">int</span> fd = dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a>;</div>
<div class="line"><span class="lineno">  655</span>    <a class="code hl_struct" href="structfs__dir__t.html">fs_dir_t</a> *_dir = dir_descriptor[dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a>].dir;</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = dir_descriptor[dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a>].filesystem;</div>
<div class="line"><span class="lineno">  657</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  658</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  659</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  660</span>    }</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a537d71bf313451145ca593fe2a63d728">dir_close</a>(fs, _dir);</div>
<div class="line"><span class="lineno">  662</span>    dir_descriptor[fd].filesystem = NULL;</div>
<div class="line"><span class="lineno">  663</span>    free(dir_descriptor[fd].dir);</div>
<div class="line"><span class="lineno">  664</span>    dir_descriptor[fd].dir = NULL;</div>
<div class="line"><span class="lineno">  665</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  667</span>}</div>
<div class="ttc" id="astructfilesystem_html_a537d71bf313451145ca593fe2a63d728"><div class="ttname"><a href="structfilesystem.html#a537d71bf313451145ca593fe2a63d728">filesystem::dir_close</a></div><div class="ttdeci">int(* dir_close)(struct filesystem *fs, fs_dir_t *dir)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00092">filesystem.h:92</a></div></div>
<div class="ttc" id="astructfs__dir__t_html"><div class="ttname"><a href="structfs__dir__t.html">fs_dir_t</a></div><div class="ttdoc">directory object</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00055">filesystem.h:55</a></div></div>
<div class="ttc" id="astructfs__dir__t_html_a9778c8a1393e7166c1e655c9ed0a829e"><div class="ttname"><a href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fs_dir_t::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00056">filesystem.h:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30e12ed09db8f77b0b4e7ffc5f1f609b" name="a30e12ed09db8f77b0b4e7ffc5f1f609b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e12ed09db8f77b0b4e7ffc5f1f609b">&#9670;&#160;</a></span>ftruncate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ftruncate </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fildes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00588">588</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  588</span>                                        {</div>
<div class="line"><span class="lineno">  589</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  590</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    <span class="keywordflow">if</span> (!is_valid_file_descriptor(fildes)) {</div>
<div class="line"><span class="lineno">  593</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  594</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  595</span>    }</div>
<div class="line"><span class="lineno">  596</span>    <a class="code hl_struct" href="structfs__file__t.html">fs_file_t</a> *file = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].file;</div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = file_descriptor[<a class="code hl_define" href="#a21683c936cc59a04b06c1fd39c40b7df">FILENO_INDEX</a>(fildes)].filesystem;</div>
<div class="line"><span class="lineno">  598</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  599</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">return</span> _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  601</span>    }</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a1318c5761c315dc5354e5154aae7d0f3">file_truncate</a>(fs, file, length);</div>
<div class="line"><span class="lineno">  604</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  607</span>}</div>
<div class="ttc" id="astructfilesystem_html_a1318c5761c315dc5354e5154aae7d0f3"><div class="ttname"><a href="structfilesystem.html#a1318c5761c315dc5354e5154aae7d0f3">filesystem::file_truncate</a></div><div class="ttdeci">int(* file_truncate)(struct filesystem *fs, fs_file_t *file, off_t length)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00089">filesystem.h:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a548e5b744ca2e97beb61ad7aa41114e2" name="a548e5b744ca2e97beb61ad7aa41114e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a548e5b744ca2e97beb61ad7aa41114e2">&#9670;&#160;</a></span>mkdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mkdir </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00230">230</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>                                         {</div>
<div class="line"><span class="lineno">  231</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  232</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  235</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  237</span>    }</div>
<div class="line"><span class="lineno">  238</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a9f586df0f698f0472b033f406de87de3">mkdir</a>(fs, entity_path, mode);</div>
<div class="line"><span class="lineno">  241</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  243</span>}</div>
<div class="ttc" id="astructfilesystem_html_a9f586df0f698f0472b033f406de87de3"><div class="ttname"><a href="structfilesystem.html#a9f586df0f698f0472b033f406de87de3">filesystem::mkdir</a></div><div class="ttdeci">int(* mkdir)(struct filesystem *fs, const char *path, mode_t mode)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00077">filesystem.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad759a0269427a564f3ce672d43e885cf" name="ad759a0269427a564f3ce672d43e885cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad759a0269427a564f3ce672d43e885cf">&#9670;&#160;</a></span>opendir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> * opendir </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00609">609</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  609</span>                               {</div>
<div class="line"><span class="lineno">  610</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  611</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  615</span>        _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  616</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  618</span>    }</div>
<div class="line"><span class="lineno">  619</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  620</span>    <span class="comment">// find dir descriptor</span></div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordtype">int</span> fd = _assign_dir_descriptor();</div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">if</span> (fd == -1) {</div>
<div class="line"><span class="lineno">  623</span>        _error_remap(-ENFILE);</div>
<div class="line"><span class="lineno">  624</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>    <a class="code hl_struct" href="structfs__dir__t.html">fs_dir_t</a> *dir = dir_descriptor[fd].dir = calloc(1, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structfs__dir__t.html">fs_dir_t</a>));</div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordflow">if</span> (dir == NULL) {</div>
<div class="line"><span class="lineno">  630</span>        _error_remap(-ENOMEM);</div>
<div class="line"><span class="lineno">  631</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  632</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  633</span>    }</div>
<div class="line"><span class="lineno">  634</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a85af88c13c623c820eca217dd81c2a2a">dir_open</a>(fs, dir, entity_path);</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line"><span class="lineno">  637</span>        free(dir);</div>
<div class="line"><span class="lineno">  638</span>        dir_descriptor[fd].dir = NULL;</div>
<div class="line"><span class="lineno">  639</span>        _error_remap(err);</div>
<div class="line"><span class="lineno">  640</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  641</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  642</span>    }</div>
<div class="line"><span class="lineno">  643</span>    dir_descriptor[fd].filesystem = fs;</div>
<div class="line"><span class="lineno">  644</span>    dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a> = fd;</div>
<div class="line"><span class="lineno">  645</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">return</span> dir;</div>
<div class="line"><span class="lineno">  648</span>}</div>
<div class="ttc" id="astructfilesystem_html_a85af88c13c623c820eca217dd81c2a2a"><div class="ttname"><a href="structfilesystem.html#a85af88c13c623c820eca217dd81c2a2a">filesystem::dir_open</a></div><div class="ttdeci">int(* dir_open)(struct filesystem *fs, fs_dir_t *dir, const char *path)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00091">filesystem.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1ebcf210f49b305423bcc413c6427ee" name="ab1ebcf210f49b305423bcc413c6427ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1ebcf210f49b305423bcc413c6427ee">&#9670;&#160;</a></span>readdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdirent.html">dirent</a> * readdir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="dirent_8h.html#ae7917177082ed5bb5a50a36bcc72a5a1">DIR</a> *</td>          <td class="paramname"><span class="paramname"><em>dir</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00669">669</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  669</span>                                 {</div>
<div class="line"><span class="lineno">  670</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  671</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>    <a class="code hl_struct" href="structfs__dir__t.html">fs_dir_t</a> *_dir = dir_descriptor[dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a>].dir;</div>
<div class="line"><span class="lineno">  674</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = dir_descriptor[dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#a9778c8a1393e7166c1e655c9ed0a829e">fd</a>].filesystem;</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">if</span> (fs == NULL) {</div>
<div class="line"><span class="lineno">  676</span>        _error_remap(-EBADF);</div>
<div class="line"><span class="lineno">  677</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  679</span>    }</div>
<div class="line"><span class="lineno">  680</span>    memset(&amp;_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>, 0, <span class="keyword">sizeof</span>(_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>));</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a36cd5c106f4d8a95cdf1ee4a73052001">dir_read</a>(fs, _dir, &amp;_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>);</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">if</span> (err == 0) {</div>
<div class="line"><span class="lineno">  683</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordflow">return</span> &amp;_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>;</div>
<div class="line"><span class="lineno">  685</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err == -ENOENT) {</div>
<div class="line"><span class="lineno">  686</span>        memset(&amp;_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>, 0, <span class="keyword">sizeof</span>(_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>));</div>
<div class="line"><span class="lineno">  687</span>        _error_remap(0);</div>
<div class="line"><span class="lineno">  688</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  690</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  691</span>        memset(&amp;_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>, 0, <span class="keyword">sizeof</span>(_dir-&gt;<a class="code hl_variable" href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">current</a>));</div>
<div class="line"><span class="lineno">  692</span>        _error_remap(err);</div>
<div class="line"><span class="lineno">  693</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  694</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  695</span>    }</div>
<div class="line"><span class="lineno">  696</span>}</div>
<div class="ttc" id="astructfilesystem_html_a36cd5c106f4d8a95cdf1ee4a73052001"><div class="ttname"><a href="structfilesystem.html#a36cd5c106f4d8a95cdf1ee4a73052001">filesystem::dir_read</a></div><div class="ttdeci">int(* dir_read)(struct filesystem *fs, fs_dir_t *dir, struct dirent *ent)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00093">filesystem.h:93</a></div></div>
<div class="ttc" id="astructfs__dir__t_html_aedd8474e43c6a35c6caed6c2469de4c5"><div class="ttname"><a href="structfs__dir__t.html#aedd8474e43c6a35c6caed6c2469de4c5">fs_dir_t::current</a></div><div class="ttdeci">struct dirent current</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00058">filesystem.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ce7c2db9fdb6aec06afaf3cfc5979c7" name="a2ce7c2db9fdb6aec06afaf3cfc5979c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ce7c2db9fdb6aec06afaf3cfc5979c7">&#9670;&#160;</a></span>rename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rename </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>old</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>new</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00212">212</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>                                             {</div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// TODO: Check if old and new are the same filesystem</span></div>
<div class="line"><span class="lineno">  214</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  215</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(old);</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  218</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  220</span>    }</div>
<div class="line"><span class="lineno">  221</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *old_entity_path = remove_prefix(old, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  222</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *new_entity_path = remove_prefix(<span class="keyword">new</span>, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a1642d2b8278ee2e0e28e67e3c871e7af">rename</a>(fs, old_entity_path, new_entity_path);</div>
<div class="line"><span class="lineno">  226</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  228</span>}</div>
<div class="ttc" id="astructfilesystem_html_a1642d2b8278ee2e0e28e67e3c871e7af"><div class="ttname"><a href="structfilesystem.html#a1642d2b8278ee2e0e28e67e3c871e7af">filesystem::rename</a></div><div class="ttdeci">int(* rename)(struct filesystem *fs, const char *oldpath, const char *newpath)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00076">filesystem.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2df76f2c62ae012c2e417813b5fe8ce" name="ab2df76f2c62ae012c2e417813b5fe8ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2df76f2c62ae012c2e417813b5fe8ce">&#9670;&#160;</a></span>rmdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rmdir </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vfs_8c_source.html#l00245">245</a> of file <a class="el" href="vfs_8c_source.html">vfs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>                            {</div>
<div class="line"><span class="lineno">  246</span>    auto_init_recursive_mutex(_mutex);</div>
<div class="line"><span class="lineno">  247</span>    recursive_mutex_enter_blocking(&amp;_mutex);</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_struct" href="structmountpoint__t.html">mountpoint_t</a> *mp = find_mountpoint(path);</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> (mp == NULL) {</div>
<div class="line"><span class="lineno">  250</span>        recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">return</span> _error_remap(-ENOENT);</div>
<div class="line"><span class="lineno">  252</span>    }</div>
<div class="line"><span class="lineno">  253</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *entity_path = remove_prefix(path, mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#ab8b25dab2ca0301ce0190df5f4efff0d">dir</a>);</div>
<div class="line"><span class="lineno">  254</span>    <a class="code hl_typedef" href="group__filesystem.html#gad16024c6aa37d328b78a38f8c006ac83">filesystem_t</a> *fs = mp-&gt;<a class="code hl_variable" href="structmountpoint__t.html#a0e33cd9afdf66cdf0417e94e6580d723">filesystem</a>;</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordtype">int</span> err = fs-&gt;<a class="code hl_variable" href="structfilesystem.html#a396727009601ff7cd9505b724dc744f3">rmdir</a>(fs, entity_path);</div>
<div class="line"><span class="lineno">  256</span>    recursive_mutex_exit(&amp;_mutex);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">return</span> _error_remap(err);</div>
<div class="line"><span class="lineno">  258</span>}</div>
<div class="ttc" id="astructfilesystem_html_a396727009601ff7cd9505b724dc744f3"><div class="ttname"><a href="structfilesystem.html#a396727009601ff7cd9505b724dc744f3">filesystem::rmdir</a></div><div class="ttdeci">int(* rmdir)(struct filesystem *fs, const char *path)</div><div class="ttdef"><b>Definition</b> <a href="filesystem_8h_source.html#l00078">filesystem.h:78</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90927805d6b48285139ab31098623df1" name="a90927805d6b48285139ab31098623df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90927805d6b48285139ab31098623df1">&#9670;&#160;</a></span>stdio_flush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void stdio_flush </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a href="dir_748a07892d0f637ff59934e757ffa80d.html">pico-vfs-REGI-Local</a></li><li class="navelem"><a href="dir_5584aeaa170479e31351d33e5b059ea9.html">src</a></li><li class="navelem"><a href="dir_b1f4b7727f9a8a8084cb37f0119e0a8f.html">filesystem</a></li><li class="navelem"><a href="vfs_8c.html">vfs.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
