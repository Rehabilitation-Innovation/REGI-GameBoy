<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_usb__msc_8c" xml:lang="en-US">
<title>lib/pico-vfs-REGI-Local/examples/usb_logger/usb_msc.c File Reference</title>
<indexterm><primary>lib/pico-vfs-REGI-Local/examples/usb_logger/usb_msc.c</primary></indexterm>
<programlisting linenumbering="unnumbered">#include &lt;string.h&gt;<?linebreak?>#include &lt;ctype.h&gt;<?linebreak?>#include &lt;bsp/board.h&gt;<?linebreak?>#include &lt;tusb.h&gt;<?linebreak?>#include &quot;blockdevice/flash.h&quot;<?linebreak?></programlisting><simplesect>
    <title>Macros    </title>
        <itemizedlist>
            <listitem><para>#define <link linkend="_usb__msc_8c_1a8e74e295b54795a32a16ea744f6aed5e">ANSI_CYAN</link>&#160;&#160;&#160;&quot;\e[36m&quot;</para>
</listitem>
            <listitem><para>#define <link linkend="_usb__msc_8c_1a8a9c0853e05b02c03acdfaab90f534c8">ANSI_MAGENTA</link>&#160;&#160;&#160;&quot;\e[35m&quot;</para>
</listitem>
            <listitem><para>#define <link linkend="_usb__msc_8c_1a6afe43652e9f792d7c2609f8d50ff47b">ANSI_CLEAR</link>&#160;&#160;&#160;&quot;\e[0m&quot;</para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para>bool <link linkend="_usb__msc_8c_1a8dc878b9ad15bf25195a23232c151089">usb_connection_status</link> (void)</para>
</listitem>
            <listitem><para>void <link linkend="_usb__msc_8c_1a13e2fb6e00b5192eef1a15d98f916448">tud_mount_cb</link> (void)</para>
</listitem>
            <listitem><para>void <link linkend="_usb__msc_8c_1a84ceba8c41ca46959876fc7cbc0e0071">tud_suspend_cb</link> (bool remote_wakeup_en)</para>
</listitem>
            <listitem><para>void <link linkend="_usb__msc_8c_1ae2aefd1e5c3d470f440cd8f07dce9991">tud_msc_inquiry_cb</link> (uint8_t lun, uint8_t vendor_id[8], uint8_t product_id[16], uint8_t product_rev[4])</para>
</listitem>
            <listitem><para>bool <link linkend="_usb__msc_8c_1abbb293c273679cadfae2b360ccd5e437">tud_msc_test_unit_ready_cb</link> (uint8_t lun)</para>
</listitem>
            <listitem><para>void <link linkend="_usb__msc_8c_1ac721126f20ec8c7358cc89ba971f6065">tud_msc_capacity_cb</link> (uint8_t lun, uint32_t *block_count, uint16_t *block_size)</para>
</listitem>
            <listitem><para>bool <link linkend="_usb__msc_8c_1ac5112ed309407dee0e18a97ca415929c">tud_msc_start_stop_cb</link> (uint8_t lun, uint8_t power_condition, bool start, bool load_eject)</para>
</listitem>
            <listitem><para>int32_t <link linkend="_usb__msc_8c_1a148e0153ce23f6ffd6305fb0e0fc4dfd">tud_msc_read10_cb</link> (uint8_t lun, uint32_t lba, uint32_t offset, void *buffer, uint32_t bufsize)</para>
</listitem>
            <listitem><para>bool <link linkend="_usb__msc_8c_1a47fd17807a02c00f4f45880d7f0ad0fa">tud_msc_is_writable_cb</link> (uint8_t lun)</para>
</listitem>
            <listitem><para>int32_t <link linkend="_usb__msc_8c_1a375a5cc4f5760603edf955765eca41a8">tud_msc_write10_cb</link> (uint8_t lun, uint32_t lba, uint32_t offset, uint8_t *buffer, uint32_t bufsize)</para>
</listitem>
            <listitem><para>int32_t <link linkend="_usb__msc_8c_1a8f5dcb9aacaba9e9932f2c941d4639e3">tud_msc_scsi_cb</link> (uint8_t lun, uint8_t const scsi_cmd[16], void *buffer, uint16_t bufsize)</para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Variables    </title>
        <itemizedlist>
            <listitem><para>bool <link linkend="_usb__msc_8c_1afb4b5379673d98e6bdf98584c040c1db">filesystem_is_exported</link></para>
</listitem>
            <listitem><para><link linkend="_group__blockdevice_1ga4bc2c146f975b5250be7f8f5f219f5e4">blockdevice_t</link> * <link linkend="_usb__msc_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link></para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Macro Definition Documentation</title>
<anchor xml:id="_usb__msc_8c_1a6afe43652e9f792d7c2609f8d50ff47b"/><section>
    <title>ANSI_CLEAR</title>
<indexterm><primary>ANSI_CLEAR</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>ANSI_CLEAR</secondary></indexterm>
<para><computeroutput>#define ANSI_CLEAR&#160;&#160;&#160;&quot;\e[0m&quot;</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00014">14</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
</section>
<anchor xml:id="_usb__msc_8c_1a8e74e295b54795a32a16ea744f6aed5e"/><section>
    <title>ANSI_CYAN</title>
<indexterm><primary>ANSI_CYAN</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>ANSI_CYAN</secondary></indexterm>
<para><computeroutput>#define ANSI_CYAN&#160;&#160;&#160;&quot;\e[36m&quot;</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00012">12</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
</section>
<anchor xml:id="_usb__msc_8c_1a8a9c0853e05b02c03acdfaab90f534c8"/><section>
    <title>ANSI_MAGENTA</title>
<indexterm><primary>ANSI_MAGENTA</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>ANSI_MAGENTA</secondary></indexterm>
<para><computeroutput>#define ANSI_MAGENTA&#160;&#160;&#160;&quot;\e[35m&quot;</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00013">13</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
</section>
</section>
<section>
<title>Function Documentation</title>
<anchor xml:id="_usb__msc_8c_1a13e2fb6e00b5192eef1a15d98f916448"/><section>
    <title>tud_mount_cb()</title>
<indexterm><primary>tud_mount_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_mount_cb</secondary></indexterm>
<para><computeroutput>void tud_mount_cb (void )</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00027">27</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00027 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00028 &#32;&#32;&#32;&#32;printf(<emphasis role="stringliteral">&quot;\e[45mmount\e[0m\n&quot;</emphasis>);
00029 &#32;&#32;&#32;&#32;usb_connected&#32;=&#32;<emphasis role="keyword">true</emphasis>;
00030 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1ac721126f20ec8c7358cc89ba971f6065"/><section>
    <title>tud_msc_capacity_cb()</title>
<indexterm><primary>tud_msc_capacity_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_capacity_cb</secondary></indexterm>
<para><computeroutput>void tud_msc_capacity_cb (uint8_t lun, uint32_t * block_count, uint16_t * block_size)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00066">66</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00067 &#32;&#32;&#32;&#32;(void)&#32;lun;
00068 &#32;&#32;&#32;&#32;*block_count&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;size(<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>)&#32;/&#32;&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;erase_size;
00069 &#32;&#32;&#32;&#32;*block_size&#32;&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;erase_size;
00070 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1ae2aefd1e5c3d470f440cd8f07dce9991"/><section>
    <title>tud_msc_inquiry_cb()</title>
<indexterm><primary>tud_msc_inquiry_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_inquiry_cb</secondary></indexterm>
<para><computeroutput>void tud_msc_inquiry_cb (uint8_t lun, uint8_t vendor_id[8], uint8_t product_id[16], uint8_t product_rev[4])</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00039">39</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00039 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00040 &#32;&#32;&#32;&#32;(void)&#32;lun;
00041 
00042 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;<emphasis role="keywordtype">char</emphasis>&#32;vid[]&#32;=&#32;<emphasis role="stringliteral">&quot;TinyUSB&quot;</emphasis>;
00043 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;<emphasis role="keywordtype">char</emphasis>&#32;pid[]&#32;=&#32;<emphasis role="stringliteral">&quot;Mass&#32;Storage&quot;</emphasis>;
00044 &#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;<emphasis role="keywordtype">char</emphasis>&#32;rev[]&#32;=&#32;<emphasis role="stringliteral">&quot;1.0&quot;</emphasis>;
00045 
00046 &#32;&#32;&#32;&#32;memcpy(vendor_id&#32;&#32;,&#32;vid,&#32;strlen(vid));
00047 &#32;&#32;&#32;&#32;memcpy(product_id&#32;,&#32;pid,&#32;strlen(pid));
00048 &#32;&#32;&#32;&#32;memcpy(product_rev,&#32;rev,&#32;strlen(rev));
00049 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a47fd17807a02c00f4f45880d7f0ad0fa"/><section>
    <title>tud_msc_is_writable_cb()</title>
<indexterm><primary>tud_msc_is_writable_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_is_writable_cb</secondary></indexterm>
<para><computeroutput>bool tud_msc_is_writable_cb (uint8_t lun)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00098">98</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00098 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00099 &#32;&#32;&#32;&#32;(void)&#32;lun;
00100 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">true</emphasis>;
00101 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a148e0153ce23f6ffd6305fb0e0fc4dfd"/><section>
    <title>tud_msc_read10_cb()</title>
<indexterm><primary>tud_msc_read10_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_read10_cb</secondary></indexterm>
<para><computeroutput>int32_t tud_msc_read10_cb (uint8_t lun, uint32_t lba, uint32_t offset, void * buffer, uint32_t bufsize)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00086">86</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00086 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00087 &#32;&#32;&#32;&#32;(void)lun;
00088 &#32;&#32;&#32;&#32;(void)offset;
00089 
00090 &#32;&#32;&#32;&#32;printf(<link linkend="_usb__msc_8c_1a8e74e295b54795a32a16ea744f6aed5e">ANSI_CYAN</link>&#32;<emphasis role="stringliteral">&quot;USB&#32;read#%lu&#32;size=%lu\n&quot;</emphasis>&#32;<link linkend="_usb__msc_8c_1a6afe43652e9f792d7c2609f8d50ff47b">ANSI_CLEAR</link>,&#32;lba,&#32;bufsize);
00091 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;err&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;read(<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>,&#32;buffer,&#32;lba&#32;*&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;erase_size,&#32;bufsize);
00092 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(err&#32;!=&#32;0)&#32;{
00093 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;printf(<emphasis role="stringliteral">&quot;read&#32;error=%d\n&quot;</emphasis>,&#32;err);
00094 &#32;&#32;&#32;&#32;}
00095 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(int32_t)&#32;bufsize;
00096 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a8f5dcb9aacaba9e9932f2c941d4639e3"/><section>
    <title>tud_msc_scsi_cb()</title>
<indexterm><primary>tud_msc_scsi_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_scsi_cb</secondary></indexterm>
<para><computeroutput>int32_t tud_msc_scsi_cb (uint8_t lun, uint8_t const scsi_cmd[16], void * buffer, uint16_t bufsize)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00122">122</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00122 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00123 &#32;&#32;&#32;&#32;(void)lun;
00124 
00125 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;*response&#32;=&#32;NULL;
00126 &#32;&#32;&#32;&#32;int32_t&#32;resplen&#32;=&#32;0;
00127 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;in_xfer&#32;=&#32;<emphasis role="keyword">true</emphasis>;
00128 
00129 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">switch</emphasis>&#32;(scsi_cmd[0])&#32;{
00130 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">default</emphasis>:
00131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tud_msc_set_sense(lun,&#32;SCSI_SENSE_ILLEGAL_REQUEST,&#32;0x20,&#32;0x00);
00132 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;resplen&#32;=&#32;-1;
00133 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
00134 &#32;&#32;&#32;&#32;}
00135 
00136 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(resplen&#32;&gt;&#32;bufsize)
00137 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;resplen&#32;=&#32;bufsize;
00138 
00139 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(response&#32;&amp;&amp;&#32;(resplen&#32;&gt;&#32;0))&#32;{
00140 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(in_xfer)&#32;{
00141 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;memcpy(buffer,&#32;response,&#32;(<emphasis role="keywordtype">size_t</emphasis>)resplen);
00142 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;;&#32;<emphasis role="comment">//&#32;SCSI&#32;output</emphasis>
00144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00145 &#32;&#32;&#32;&#32;}
00146 
00147 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(int32_t)resplen;
00148 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1ac5112ed309407dee0e18a97ca415929c"/><section>
    <title>tud_msc_start_stop_cb()</title>
<indexterm><primary>tud_msc_start_stop_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_start_stop_cb</secondary></indexterm>
<para><computeroutput>bool tud_msc_start_stop_cb (uint8_t lun, uint8_t power_condition, bool start, bool load_eject)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00072">72</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00072 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00073 &#32;&#32;&#32;&#32;(void)&#32;lun;
00074 &#32;&#32;&#32;&#32;(void)&#32;power_condition;
00075 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(&#32;load_eject&#32;)&#32;{
00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(start)&#32;{
00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;load&#32;disk&#32;storage</emphasis>
00078 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
00079 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;unload&#32;disk&#32;storage</emphasis>
00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ejected&#32;=&#32;<emphasis role="keyword">true</emphasis>;
00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00082 &#32;&#32;&#32;&#32;}
00083 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">true</emphasis>;
00084 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1abbb293c273679cadfae2b360ccd5e437"/><section>
    <title>tud_msc_test_unit_ready_cb()</title>
<indexterm><primary>tud_msc_test_unit_ready_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_test_unit_ready_cb</secondary></indexterm>
<para><computeroutput>bool tud_msc_test_unit_ready_cb (uint8_t lun)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00051">51</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00051 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00052 &#32;&#32;&#32;&#32;(void)&#32;lun;
00053 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(!<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1afb4b5379673d98e6bdf98584c040c1db">filesystem_is_exported</link>)&#32;{
00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tud_msc_set_sense(lun,&#32;SCSI_SENSE_NOT_READY,&#32;0x3a,&#32;0x00);
00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">false</emphasis>;
00056 &#32;&#32;&#32;&#32;}
00057 
00058 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(ejected)&#32;{
00059 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tud_msc_set_sense(lun,&#32;SCSI_SENSE_NOT_READY,&#32;0x3a,&#32;0x00);
00060 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">false</emphasis>;
00061 &#32;&#32;&#32;&#32;}
00062 
00063 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">true</emphasis>;
00064 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a375a5cc4f5760603edf955765eca41a8"/><section>
    <title>tud_msc_write10_cb()</title>
<indexterm><primary>tud_msc_write10_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_msc_write10_cb</secondary></indexterm>
<para><computeroutput>int32_t tud_msc_write10_cb (uint8_t lun, uint32_t lba, uint32_t offset, uint8_t * buffer, uint32_t bufsize)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00103">103</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00104 &#32;&#32;&#32;&#32;(void)lun;
00105 &#32;&#32;&#32;&#32;(void)offset;
00106 
00107 &#32;&#32;&#32;&#32;printf(<link linkend="_usb__msc_8c_1a8a9c0853e05b02c03acdfaab90f534c8">ANSI_MAGENTA</link>&#32;<emphasis role="stringliteral">&quot;USB&#32;write#%lu&#32;bufsize=%lu\n&quot;</emphasis>&#32;<link linkend="_usb__msc_8c_1a6afe43652e9f792d7c2609f8d50ff47b">ANSI_CLEAR</link>,&#32;lba,&#32;bufsize);
00108 
00109 &#32;&#32;&#32;&#32;uint32_t&#32;block_size&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;erase_size;
00110 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;err&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;erase(<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>,&#32;lba&#32;*&#32;block_size,&#32;bufsize);
00111 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(err&#32;!=&#32;<link linkend="_blockdevice_8h_1a6202ecf5974ef985db5f3a2adfd81abba75df174773e6ad20c734b0cee152387c">BD_ERROR_OK</link>)&#32;{
00112 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;printf(<emphasis role="stringliteral">&quot;erase&#32;error=%d\n&quot;</emphasis>,&#32;err);
00113 &#32;&#32;&#32;&#32;}
00114 &#32;&#32;&#32;&#32;err&#32;=&#32;<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>-&gt;program(<link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4">flash2</link>,&#32;buffer,&#32;lba&#32;*&#32;block_size,&#32;bufsize);
00115 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(err&#32;!=&#32;<link linkend="_blockdevice_8h_1a6202ecf5974ef985db5f3a2adfd81abba75df174773e6ad20c734b0cee152387c">BD_ERROR_OK</link>)&#32;{
00116 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;printf(<emphasis role="stringliteral">&quot;program&#32;error=%d\n&quot;</emphasis>,&#32;err);
00117 &#32;&#32;&#32;&#32;}
00118 
00119 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(int32_t)bufsize;
00120 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a84ceba8c41ca46959876fc7cbc0e0071"/><section>
    <title>tud_suspend_cb()</title>
<indexterm><primary>tud_suspend_cb</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>tud_suspend_cb</secondary></indexterm>
<para><computeroutput>void tud_suspend_cb (bool remote_wakeup_en)</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00032">32</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00032 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00033 &#32;&#32;&#32;&#32;(void)remote_wakeup_en;
00034 
00035 &#32;&#32;&#32;&#32;printf(<emphasis role="stringliteral">&quot;\e[45msuspend\e[0m\n&quot;</emphasis>);
00036 &#32;&#32;&#32;&#32;usb_connected&#32;=&#32;<emphasis role="keyword">false</emphasis>;
00037 }
</programlisting></section>
<anchor xml:id="_usb__msc_8c_1a8dc878b9ad15bf25195a23232c151089"/><section>
    <title>usb_connection_status()</title>
<indexterm><primary>usb_connection_status</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>usb_connection_status</secondary></indexterm>
<para><computeroutput>bool usb_connection_status (void )</computeroutput></para><para>
Definition at line <link linkend="_usb__msc_8c_source_1l00023">23</link> of file <link linkend="_usb__msc_8c_source">usb_msc.c</link>.</para>
<programlisting linenumbering="unnumbered">00023 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00024 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;usb_connected;
00025 }
</programlisting></section>
</section>
<section>
<title>Variable Documentation</title>
<anchor xml:id="_usb__msc_8c_1afb4b5379673d98e6bdf98584c040c1db"/><section>
    <title>filesystem_is_exported</title>
<indexterm><primary>filesystem_is_exported</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>filesystem_is_exported</secondary></indexterm>
<para><computeroutput>bool filesystem_is_exported<computeroutput>[extern]</computeroutput></computeroutput></para><para>
Definition at line <link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_source_1l00023">23</link> of file <link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_source">main.c</link>.</para>
</section>
<anchor xml:id="_usb__msc_8c_1ad8ecc24e18a9575a8814a8eafeb8a3b4"/><section>
    <title>flash2</title>
<indexterm><primary>flash2</primary><secondary>usb_msc.c</secondary></indexterm>
<indexterm><primary>usb_msc.c</primary><secondary>flash2</secondary></indexterm>
<para><computeroutput><link linkend="_group__blockdevice_1ga4bc2c146f975b5250be7f8f5f219f5e4">blockdevice_t</link>* flash2<computeroutput>[extern]</computeroutput></computeroutput></para><para>
Definition at line <link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_source_1l00026">26</link> of file <link linkend="_pico-vfs-_r_e_g_i-_local_2examples_2usb__logger_2main_8c_source">main.c</link>.</para>
</section>
</section>
</section>
