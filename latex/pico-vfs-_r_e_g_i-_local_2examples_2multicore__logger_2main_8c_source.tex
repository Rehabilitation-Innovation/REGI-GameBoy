\doxysection{main.\+c}
\hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source}{}\label{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source}\index{lib/pico-\/vfs-\/REGI-\/Local/examples/multicore\_logger/main.c@{lib/pico-\/vfs-\/REGI-\/Local/examples/multicore\_logger/main.c}}
\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00001}00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00002}00002\ \textcolor{comment}{\ *\ Multi-\/core\ logger\ that\ saves\ 1kHz\ sampling\ data\ to\ an\ SD\ card}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00003}00003\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00004}00004\ \textcolor{comment}{\ *\ This\ code\ is\ not\ specifically\ tuned.\ The\ data\ is\ substituted\ with\ random\ numbers,}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00005}00005\ \textcolor{comment}{\ *\ and\ the\ actual\ application\ will\ probably\ be\ reading\ the\ ADC\ or\ communicating\ with}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00006}00006\ \textcolor{comment}{\ *\ the\ sensor\ chip.\ Also,\ the\ method\ of\ outputting\ CSV\ files\ is\ slow.\ The\ method\ of}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00007}00007\ \textcolor{comment}{\ *\ outputting\ binary\ data\ is\ faster.}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00008}00008\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00009}00009\ \textcolor{comment}{\ *\ Copyright\ 2024,\ Hiroyuki\ OYAMA}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00010}00010\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00011}00011\ \textcolor{comment}{\ *\ SPDX-\/License-\/Identifier:\ BSD-\/3-\/Clause}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00012}00012\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00013}00013\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00014}00014\ \textcolor{preprocessor}{\#include\ <pico/multicore.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00015}00015\ \textcolor{preprocessor}{\#include\ <pico/stdlib.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00016}00016\ \textcolor{preprocessor}{\#include\ <pico/time.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00017}00017\ \textcolor{preprocessor}{\#include\ <pico/util/queue.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00018}00018\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00019}00019\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00020}00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vfs_8h}{filesystem/vfs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00022}00022\ \textcolor{preprocessor}{\#if\ !defined(SAMPLING\_RATE\_HZ)}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00023}\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a678ae58402d3a72ca43f90e63c6b61ca}{00023}}\ \textcolor{preprocessor}{\#define\ SAMPLING\_RATE\_HZ\ \ 1000}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00024}00024\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00026}\mbox{\hyperlink{structsensor__data__t}{00026}}\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00027}\mbox{\hyperlink{structsensor__data__t_a248f154dac0f2c9bff4ba9d7f4dba970}{00027}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a248f154dac0f2c9bff4ba9d7f4dba970}{accel\_x}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00028}\mbox{\hyperlink{structsensor__data__t_a2c667e86c78184338501c9e8a7084ffa}{00028}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a2c667e86c78184338501c9e8a7084ffa}{accel\_y}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00029}\mbox{\hyperlink{structsensor__data__t_a1611c6d4224825afe216052a6d92bc90}{00029}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a1611c6d4224825afe216052a6d92bc90}{accel\_z}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00030}\mbox{\hyperlink{structsensor__data__t_a7c9c3c482f40abe3c661b1ff8f17aea7}{00030}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a7c9c3c482f40abe3c661b1ff8f17aea7}{gyro\_x}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00031}\mbox{\hyperlink{structsensor__data__t_acf35d0f785e8ea17be52eb6db09d926b}{00031}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_acf35d0f785e8ea17be52eb6db09d926b}{gyro\_y}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00032}\mbox{\hyperlink{structsensor__data__t_ad6de374d79338ca5c47d08fefbba0efa}{00032}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_ad6de374d79338ca5c47d08fefbba0efa}{gyro\_z}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00033}\mbox{\hyperlink{structsensor__data__t_a24eea7c67c329879a83f2d6abd0e3270}{00033}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a24eea7c67c329879a83f2d6abd0e3270}{mag\_x}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00034}\mbox{\hyperlink{structsensor__data__t_aec0b388a1ef17f0a0b435f31882a154a}{00034}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_aec0b388a1ef17f0a0b435f31882a154a}{mag\_y}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00035}\mbox{\hyperlink{structsensor__data__t_a5acd8af8c47db2b4ef47f1531b87bc72}{00035}}\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{structsensor__data__t_a5acd8af8c47db2b4ef47f1531b87bc72}{mag\_z}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00036}\mbox{\hyperlink{structsensor__data__t_a317681c3b45202a0ad429582c26a3d67}{00036}}\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{structsensor__data__t_a317681c3b45202a0ad429582c26a3d67}{timestamp}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00037}00037\ \}\ \mbox{\hyperlink{structsensor__data__t}{sensor\_data\_t}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00039}\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{00039}}\ queue\_t\ \mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00040}00040\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ write\_buffer[1024\ *\ 8];}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00042}00042\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{float}\ normal\_random(\textcolor{keywordtype}{float}\ mean,\ \textcolor{keywordtype}{float}\ stddev)\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00043}00043\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ has\_spare\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{float}\ spare;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_spare)\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00047}00047\ \ \ \ \ \ \ \ \ has\_spare\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mean\ +\ stddev\ *\ spare;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00049}00049\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00051}00051\ \ \ \ \ has\_spare\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00052}00052\ \ \ \ \ \textcolor{keywordtype}{float}\ u,\ v,\ s;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00054}00054\ \ \ \ \ \ \ \ \ u\ =\ (float)rand()\ /\ RAND\_MAX\ *\ 2.0f\ -\/\ 1.0f;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00055}00055\ \ \ \ \ \ \ \ \ v\ =\ (float)rand()\ /\ RAND\_MAX\ *\ 2.0f\ -\/\ 1.0f;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00056}00056\ \ \ \ \ \ \ \ \ s\ =\ u\ *\ u\ +\ v\ *\ v;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00057}00057\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (s\ >=\ 1.0f\ ||\ s\ ==\ 0.0f);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00059}00059\ \ \ \ \ s\ =\ sqrtf(-\/2.0f\ *\ logf(s)\ /\ s);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00060}00060\ \ \ \ \ spare\ =\ v\ *\ s;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{return}\ mean\ +\ stddev\ *\ u\ *\ s;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00062}00062\ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00064}00064\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ sampling\_task(repeating\_timer\_t\ *\mbox{\hyperlink{_dino_game_8cpp_a87accd1af8e0aff4b818d891374f7cec}{t}})\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00065}00065\ \ \ \ \ (void)\mbox{\hyperlink{_dino_game_8cpp_a87accd1af8e0aff4b818d891374f7cec}{t}};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00066}00066\ \ \ \ \ \mbox{\hyperlink{structsensor__data__t}{sensor\_data\_t}}\ entry\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00068}00068\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a317681c3b45202a0ad429582c26a3d67}{timestamp}}\ =\ (uint64\_t)get\_absolute\_time();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00069}00069\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a248f154dac0f2c9bff4ba9d7f4dba970}{accel\_x}}\ =\ normal\_random(0,\ 0.01);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00070}00070\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a2c667e86c78184338501c9e8a7084ffa}{accel\_y}}\ =\ normal\_random(0,\ 0.01);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00071}00071\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a1611c6d4224825afe216052a6d92bc90}{accel\_z}}\ =\ normal\_random(-\/1.0,\ 0.01);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00072}00072\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a7c9c3c482f40abe3c661b1ff8f17aea7}{gyro\_x}}\ =\ normal\_random(0,\ 0.001);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00073}00073\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_acf35d0f785e8ea17be52eb6db09d926b}{gyro\_y}}\ =\ normal\_random(0,\ 0.001);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00074}00074\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_ad6de374d79338ca5c47d08fefbba0efa}{gyro\_z}}\ =\ normal\_random(0,\ 0.001);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00075}00075\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a24eea7c67c329879a83f2d6abd0e3270}{mag\_x}}\ =\ normal\_random(-\/0.25,\ 0.0001);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00076}00076\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_aec0b388a1ef17f0a0b435f31882a154a}{mag\_y}}\ =\ normal\_random(0.1,\ 0.01);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00077}00077\ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a5acd8af8c47db2b4ef47f1531b87bc72}{mag\_z}}\ =\ normal\_random(0.4,\ 0.01);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00079}00079\ \ \ \ \ queue\_try\_add(\&\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}},\ \&entry);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00081}00081\ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00083}00083\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ produce\_sensor\_data\_task(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00084}00084\ \ \ \ \ repeating\_timer\_t\ timer;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00085}00085\ \ \ \ \ add\_repeating\_timer\_us((int64\_t)((1.0\ /\ \mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a678ae58402d3a72ca43f90e63c6b61ca}{SAMPLING\_RATE\_HZ}})\ *\ -\/1000000),}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&sampling\_task,\ NULL,\ \&timer);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00087}00087\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00088}00088\ \ \ \ \ \ \ \ \ \_\_wfi();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00089}00089\ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00091}\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a840291bc02cba5474a4cb46a9b9566fe}{00091}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{pico-distance-sensor-main_2pico-distance-sensor-main_2test_2test__program_2main_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00092}00092\ \ \ \ \ stdio\_init\_all();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00093}00093\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{group__filesystem_gafb19e37469a751aa61de3dcd0c70b4b0}{fs\_init}}())\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00094}00094\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}SD\ card\ device\ not\ found\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00096}00096\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00098}00098\ \ \ \ \ queue\_init(\&\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structsensor__data__t}{sensor\_data\_t}}),\ 1024);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00099}00099\ \ \ \ \ FILE\ *fp\ =\ fopen(\textcolor{stringliteral}{"{}/sd/sensor\_data.csv"{}},\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00100}00100\ \ \ \ \ \textcolor{keywordflow}{if}\ (fp\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00101}00101\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}fopen\ failed:\ \%s\(\backslash\)n"{}},\ strerror(errno));}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00102}00102\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00103}00103\ \ \ \ \ setvbuf(fp,\ write\_buffer,\ \_IOFBF,\ \textcolor{keyword}{sizeof}(write\_buffer));}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00104}00104\ \ \ \ \ fprintf(fp,\ \textcolor{stringliteral}{"{}Time,AccelX,AccelY,AccelZ,GyroX,GyroY,GyroZ,MagX,MagY,Magz\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00106}00106\ \ \ \ \ multicore\_reset\_core1();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00107}00107\ \ \ \ \ sleep\_ms(100);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00108}00108\ \ \ \ \ multicore\_launch\_core1(produce\_sensor\_data\_task);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00110}00110\ \ \ \ \ \mbox{\hyperlink{structsensor__data__t}{sensor\_data\_t}}\ entry\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00111}00111\ \ \ \ \ absolute\_time\_t\ last\_checkpoint\ =\ get\_absolute\_time();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00112}00112\ \ \ \ \ uint32\_t\ n\ =\ 0;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00113}00113\ \ \ \ \ \textcolor{keywordflow}{while}\ (1)\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00114}00114\ \ \ \ \ \ \ \ \ queue\_remove\_blocking(\&\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}},\ \&entry);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00115}00115\ \ \ \ \ \ \ \ \ fprintf(fp,\ \textcolor{stringliteral}{"{}\%.6f,\%.6f,\%.6f,\%.6f,\%.6f,\%.6f,\%.6f,\%.6f,\%.6f,\%.6f\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})entry.\mbox{\hyperlink{structsensor__data__t_a317681c3b45202a0ad429582c26a3d67}{timestamp}}\ /\ 1000\ /\ 1000,}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a248f154dac0f2c9bff4ba9d7f4dba970}{accel\_x}},\ entry.\mbox{\hyperlink{structsensor__data__t_a2c667e86c78184338501c9e8a7084ffa}{accel\_y}},\ entry.\mbox{\hyperlink{structsensor__data__t_a1611c6d4224825afe216052a6d92bc90}{accel\_z}},}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a7c9c3c482f40abe3c661b1ff8f17aea7}{gyro\_x}},\ entry.\mbox{\hyperlink{structsensor__data__t_acf35d0f785e8ea17be52eb6db09d926b}{gyro\_y}},\ entry.\mbox{\hyperlink{structsensor__data__t_a7c9c3c482f40abe3c661b1ff8f17aea7}{gyro\_x}},}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entry.\mbox{\hyperlink{structsensor__data__t_a24eea7c67c329879a83f2d6abd0e3270}{mag\_x}},\ entry.\mbox{\hyperlink{structsensor__data__t_aec0b388a1ef17f0a0b435f31882a154a}{mag\_y}},\ entry.\mbox{\hyperlink{structsensor__data__t_a5acd8af8c47db2b4ef47f1531b87bc72}{mag\_z}});}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ n\ +=\ 1;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ absolute\_time\_t\ now\ =\ get\_absolute\_time();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00122}00122\ \ \ \ \ \ \ \ \ int64\_t\ duration\ =\ absolute\_time\_diff\_us(last\_checkpoint,\ now);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (duration\ >=\ 1000000)\ \{}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Store\ \%lu\ samples/sec,\ Remaining\ queue\ \%u\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n,\ queue\_get\_level(\&\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}}));}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ 0;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ last\_checkpoint\ =\ now;}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00128}00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00129}00129\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00131}00131\ \ \ \ \ fclose(fp);}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00132}00132\ \ \ \ \ queue\_free(\&\mbox{\hyperlink{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_a3c4ae488ab07f78a56116146dc0d322d}{sensor\_queue}});}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00134}00134\ \ \ \ \ \textcolor{keywordflow}{while}\ (1)}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00135}00135\ \ \ \ \ \ \ \ \ tight\_loop\_contents();}
\DoxyCodeLine{\Hypertarget{pico-vfs-_r_e_g_i-_local_2examples_2multicore__logger_2main_8c_source_l00136}00136\ \}}

\end{DoxyCode}
